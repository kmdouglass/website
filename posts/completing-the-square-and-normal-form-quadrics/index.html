<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="I explain how to convert the expression for the sag of an optical surface into the normal form of a quadric equation.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Completing the Square and the Normal Form of Quadrics | Kyle M. Douglass</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://kylemdouglass.com/posts/completing-the-square-and-normal-form-quadrics/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Kyle M. Douglass">
<link rel="prev" href="../why-is-camera-read-noise-gaussian-distributed/" title="Why is Camera Read Noise Gaussian Distributed?" type="text/html">
<link rel="next" href="../the-axis-of-symmetry-of-a-parabola-and-the-eigenvectors-of-its-matrix-representation/" title="The Axis of Symmetry of a Parabola and the Eigenvectors of its Matrix Representation" type="text/html">
<meta property="og:site_name" content="Kyle M. Douglass">
<meta property="og:title" content="Completing the Square and the Normal Form of Quadrics">
<meta property="og:url" content="https://kylemdouglass.com/posts/completing-the-square-and-normal-form-quadrics/">
<meta property="og:description" content="I explain how to convert the expression for the sag of an optical surface into the normal form of a quadric equation.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-07-07T08:42:35+02:00">
<meta property="article:tag" content="algebra">
<meta property="article:tag" content="algebraic geometry">
<meta property="article:tag" content="mathematics">
<meta property="article:tag" content="ray tracing">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Kyle M. Douglass</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>
                </li>
<li class="nav-item">
<a href="https://kmdouglass.github.io/" class="nav-link">Previous</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.md" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Completing the Square and the Normal Form of Quadrics</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Kyle M. Douglass
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2025-07-07T08:42:35+02:00" itemprop="datePublished" title="2025-07-07 08:42">2025-07-07 08:42</time></a>
            </p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/completing-the-square-and-the-normal-form-of-quadrics.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I am working on rendering cross section views of optical systems for my ray tracer. The problem is one of finding the intersection curve between a plane (the cutting plane) and a <a href="https://en.wikipedia.org/wiki/Quadric">quadric surface</a> which represents an interface between two media with different refractive indexes. Quadric surfaces are important primitives for modeling optical interfaces because they represent common surface types in optics, such as spheroids and paraboloids. A pair of quadrics, or a quadric and a plane, models a common lens.</p>
<p>In 3D, the implicit surface equation for a quadric is</p>
<p>$$
A x^2 + B y^2 + C z^2 + D x y + E y z + F x z + G x + H y + I z + J = 0
$$</p>
<p>Any quadric can be reduced to a so-called <a href="https://en.wikipedia.org/wiki/Quadric#Euclidean_space">normal form</a> that identifies its class, i.e. ellipsoid, hyperbolic paraboloid, etc. Except for paraboloids, none of the normal form equations contain linear terms in \( x \), \( y \), or \( z \).</p>
<p>A quadric of revolution occurs when two or more of the parameters of the the quadric's normal form are equal, such as \( x^2 / R^2 + y^2 / R^2 + z^2 / R^2 = 1 \), which is the equation for a spheroid with radius parameter \( R \)<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>. Quadrics of revolution are the surface types most-often encountered in optics<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>.</p>
<p>The surface sag of a quadric surface is a very important quantity for ray tracing. The sag of a quadric is usually given in terms of the <a href="https://en.wikipedia.org/wiki/Conic_constant">conic constant</a>, \( K \). One obtains the sag by solving the following quadric equation for \( z \):</p>
<p>$$
x^2 + y^2 - 2 R z + ( K + 1 ) z^2 = 0
$$</p>
<p>Here, \( R \) is the radius of curvature of the surface at its apex, \( x = y = z = 0 \).</p>
<p>At this point I asked myself how I could rewrite the above expression in its normal form, and for a while I was unable to do it. After a bit of searching on the internet, I eventually realized that the solution involves <a href="https://en.wikipedia.org/wiki/Completing_the_square">completing the square</a>, a topic that was not given much attention during my high school education. After this exercise, I realize now that the purpose of completing the square is to essentially <strong>move any linear terms of a quadratic equation into squared parantheses</strong>. This allows one to then remove the linear terms entirely by applying a suitable transformation, leaving only quadratic and constant terms.</p>
<h2>Converting the Quadric to its Normal Form</h2>
<p>The conversion of the above equation proceeds as follows. We first factor out \( ( K + 1 ) \) from the terms involving \( z \).</p>
<p>$$
x^2 + y^2 + ( K + 1 ) \left[ z^2 - \frac{ 2 R z }{ K + 1 }\right] = 0
$$</p>
<p>Next, we "add zero" to the term inside the square brackets by adding \( [ 2 R / 2 ( K + 1 ) ]^2 - [ 2 R / 2 ( K + 1 ) ]^2 = [ R / ( K + 1 ) ]^2 - [ R / ( K + 1 ) ]^2 \):</p>
<p>$$
x^2 + y^2 + ( K + 1 ) \left[ z^2 - \frac{ 2 R z }{ K + 1 } + \left( \frac{ R }{ K + 1 } \right)^2 - \left( \frac{ R }{ K + 1 } \right)^2 \right] = 0
$$</p>
<p>We can understand this a bit more generally by considering the expression \( z^2 - a z \). Here I need to add and subtract \( ( a / 2 )^2 \). The reason is that now we can rewrite the first three terms inside the square brackets as a squared binomial:</p>
<p>$$
x^2 + y^2 + ( K + 1 ) \left[ \left( z - \frac{ R }{ K + 1 } \right)^2 - \left( \frac{ R } { K + 1 } \right)^2 \right] = 0
$$</p>
<p>These last two steps complete the square. To place the equation into its normal form, I apply the Euclidean transformation \( z' = z - \frac{ R }{ K + 1 } \) and carry through the \( K + 1 \).</p>
<p>$$
x^2 + y^2 + ( K + 1 ) z^{ \prime 2 } - R^2 / ( K + 1 ) = 0
$$</p>
<p>The above equation is <em>almost</em> a normal form expression for a quadric. To finish the job, I would need to substiute in a specific value for the conic constant and divide through so that the constant is either -1, 0, or 1.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>The coefficients of each term need not be equal in general. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>A cylindrical lens does actually contain a quadric, but rather would consist of at least one toroidal surface. These are less common than lenses with spherical profiles, however. <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/algebra/" rel="tag">algebra</a></li>
            <li><a class="tag p-category" href="../../categories/algebraic-geometry/" rel="tag">algebraic geometry</a></li>
            <li><a class="tag p-category" href="../../categories/mathematics/" rel="tag">mathematics</a></li>
            <li><a class="tag p-category" href="../../categories/ray-tracing/" rel="tag">ray tracing</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../why-is-camera-read-noise-gaussian-distributed/" rel="prev" title="Why is Camera Read Noise Gaussian Distributed?">Previous post</a>
            </li>
            <li class="next">
                <a href="../the-axis-of-symmetry-of-a-parabola-and-the-eigenvectors-of-its-matrix-representation/" rel="next" title="The Axis of Symmetry of a Parabola and the Eigenvectors of its Matrix Representation">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="kyle-m-douglass",
            disqus_url="https://kylemdouglass.com/posts/completing-the-square-and-normal-form-quadrics/",
        disqus_title="Completing the Square and the Normal Form of Quadrics",
        disqus_identifier="cache/posts/completing-the-square-and-the-normal-form-of-quadrics.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><script>var disqus_shortname="kyle-m-douglass";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2025         <a href="mailto:kyle.m.douglass@gmail.com">Kyle M. Douglass</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
