<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="description" content="I present a first version of an analog dimmer circuit for high power LEDs.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>An Analog LED Dimmer Circuit | Kyle M. Douglass</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="https://kylemdouglass.com/posts/an-analog-led-dimmer-circuit/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Kyle M. Douglass">
<link rel="prev" href="../meta-biophysics-of-the-cell/" title="Meta-Biophysics of the Cell" type="text/html">
<link rel="next" href="../data-type-alignment-for-ray-tracing-in-rust/" title="Data Type Alignment for Ray Tracing in Rust" type="text/html">
<meta property="og:site_name" content="Kyle M. Douglass">
<meta property="og:title" content="An Analog LED Dimmer Circuit">
<meta property="og:url" content="https://kylemdouglass.com/posts/an-analog-led-dimmer-circuit/">
<meta property="og:description" content="I present a first version of an analog dimmer circuit for high power LEDs.">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-01-17T09:08:27+01:00">
<meta property="article:tag" content="electronics">
<meta property="article:tag" content="optics">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Kyle M. Douglass</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>
                </li>
<li class="nav-item">
<a href="https://kmdouglass.github.io/" class="nav-link">Previous</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.md" id="sourcelink" class="nav-link">Source</a>
    </li>


                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
        
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">An Analog LED Dimmer Circuit</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Kyle M. Douglass
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2025-01-17T09:08:27+01:00" itemprop="datePublished" title="2025-01-17 09:08">2025-01-17 09:08</time></a>
            </p>
                <p class="commentline">
    
    <a href="#disqus_thread" data-disqus-identifier="cache/posts/an-analog-led-dimmer-circuit.html">Comments</a>


            
        </p>
<p class="sourceline"><a href="index.md" class="sourcelink">Source</a></p>

        </div>
        

    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>I recently needed to build a circuit to control the brightness of a 4 W LED with a knob. I know basic electronics, and I thought this would be easy. I spoke to a few people whom I know and are knowledgable in electronics. I also asked people on Reddit. A lot of people said it would be easy.</p>
<p>As it turns it, it wasn't easy.</p>
<h2>The Requirements</h2>
<p>My requirments are simple:</p>
<ul>
<li>The brightness should be manually adjustable with a knob from OFF to nearly full ON.</li>
<li>The LED will serve as the light source of a microscope trans-illuminator. It should work across a large range of frame acquisition rates (1 Hz to 1 kHz, or exposure times of 1 ms to 1 s).</li>
<li>The range of brightnesses should be variable across the dynamic range of the camera, which in my case is 35,000:1, or about 90 dB.</li>
</ul>
<p>I don't care about efficiency. I don't care about whether I can use a Raspberry Pi to control it. I don't care whether it can be turned on or off with different logic levels. I just want a knob that I can turn to make the LED brighter or dimmer.</p>
<p>In spite of the insistence of several people that I communicated with on the internet, I decided that the second requirement would preclude using pulse width modulation (PWM) to dim the LED. Even when I could convince others that PWM almost always causes aliasing at high frame rates, they tried to find obscure work arounds so I could still use PWM. I really do appreciate all the feedback I got. But I also learned that PWM is the hammer of the electronics world that makes everything look like a nail<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup>.</p>
<h2>The Circuit</h2>
<p>I reached out to a friend of mine who's a wizard at analog electronics<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>. He suggested to use a MOSFET and to vary the gate-source voltage to control the current through the LED.</p>
<p>After a lot of thinking and reading, I arrived at <a href="https://tinyurl.com/2cnw45fy">the following circuit</a>:</p>
<figure><img src="../../images/led-dimmer-circuit-v0.png"></figure><p>The LED is an Osram Oslon star LED (LST1-01F05-4070-01) with a maximum current of 1.3 A and a maximum forward voltage of 3.2 V. The MOSFET is an IRF510, whose gate-source threshold voltage is about 3 V.</p>
<p>Here's a brief explanation of what each component does:</p>
<ol>
<li>
<strong>Voltage source</strong> : This is just a 12 V wall wart.</li>
<li>
<strong>200 nF capacitor</strong> : This smooths out any fluctuations from the wall wart.</li>
<li>
<strong>50 kOhm potentiometer</strong> : The "knob." Turning it will vary the gate-source voltage of the MOSFET, which controls how much current flows through the LED.</li>
<li>
<strong>50 kOhm resistor</strong> : This along with the potentiometer forms a voltage divider to keep the minimum voltage at the MOSFET gate close to where the LED turns on. Without it, you need to rotate the potentiometer almost half of its full range for the LED to turn on.</li>
<li>
<strong>300 nF capacitor</strong> : A debounce capacitor that smooths out the mechanical irregularities of the pot when it turns.</li>
<li>
<strong>IRF510 MOSFET</strong> : Basically a valve that I can vary continuously to control the LED current by setting the voltage at the gate.</li>
<li>
<strong>LED</strong> : So pretty.</li>
<li>
<strong>10 Ohm resistor</strong> : This limits the current through the resistor. I calculated its value by dividing the maximum supply voltage minus the maximum forward voltage drop across the LED by the maximum current, then rounded up for safety.</li>
</ol>
<p>$$ R = \frac{V}{I} = \frac{\left( 12 \, V - 3.2 \, V \right) }{1.3 \, A} = 6.8 \Omega $$</p>
<p>The resistor also has to handle a large power dissipation at the maximum current:</p>
<p>$$ P = I^2 R = \left(1.3 \, A \right)^2 \left( 10 \Omega \right) = 16.9 W $$</p>
<p>I decided instead to keep the current to less than 1 Amp so that I could use a 10 Watt resistor that I had.</p>
<p>Power dissipation is also why we don't just use a potentiometer to control the LED current: my pots were only rated up to about 50 mW, whereas I expected that the MOSFET would have handle loads on the order of Watts due to the high current.</p>
<h2>What I Learned</h2>
<h3>I really need to study MOSFETS</h3>
<p>I still don't really know how to solve circuits with MOSFETs. I arrived at the above circuit largely by trial-and-error on a prototype and by performing naive calculations on the voltage divider that turned out to not be entirely correct. I also expected that the LED would turn on once I passed the MOSFET's gate-source voltage threshold, but this turned out to be off by about 2 or 3 V.</p>
<h3>MOSFETs suffer from second order effects</h3>
<p>There is currently a hysteresis in the gate-ground voltage at when the LED turns on and when it turns off by about half a Volt. According to a helpful person on Reddit, this is likely due to a change in both the LEDs forward voltage and the MOSFET's threshold voltage with temperature once the current starts flowing. A possible fix is to swap the order of the LED and the MOSFET so that only the MOSFET will contribute to the hysteresis.</p>
<h3>You can always complicate things to make them better</h3>
<p>The same person on Reddit above also suggested making the circuit robust to temperature variations by adding an opamp to control the MOSFET gate voltage. It would compensate for temperature changes by comparing the potentiometer value to the 10 Ohm resistor in a closed feedback loop.</p>
<h3>Electronics is an art</h3>
<p>Yes, electronics is a science, but I would argue that having to mentally juggle second order effects and the fact that experts seem to make an initial design "by feel" are signatures of an art.</p>
<p>It also struck me how nearly every step of the process forced me to take a detour to address something I hadn't at first considered, such as current limits in the wires and large variations in the MOSFET specs.</p>
<p>The next time I need to do something like this, I will expect the problem to take longer to solve than I first anticipate.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn:1">
<p>To my non-native English speaking readers: I mean that people try to use PWM to solve problems where it's not appropriate. <a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 1 in the text">↩</a></p>
</li>
<li id="fn:2">
<p>And if you play electric guitar, be sure to check out his handmade effects pedals: <a href="https://www.volumeandpower.com/">https://www.volumeandpower.com/</a>. <a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 2 in the text">↩</a></p>
</li>
</ol>
</div>
    </div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/electronics/" rel="tag">electronics</a></li>
            <li><a class="tag p-category" href="../../categories/optics/" rel="tag">optics</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../meta-biophysics-of-the-cell/" rel="prev" title="Meta-Biophysics of the Cell">Previous post</a>
            </li>
            <li class="next">
                <a href="../data-type-alignment-for-ray-tracing-in-rust/" rel="next" title="Data Type Alignment for Ray Tracing in Rust">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
        
    
        <div id="disqus_thread"></div>
        <script>
        var disqus_shortname ="kyle-m-douglass",
            disqus_url="https://kylemdouglass.com/posts/an-analog-led-dimmer-circuit/",
        disqus_title="An Analog LED Dimmer Circuit",
        disqus_identifier="cache/posts/an-analog-led-dimmer-circuit.html",
        disqus_config = function () {
            this.language = "en";
        };
        (function() {
            var dsq = document.createElement('script'); dsq.async = true;
            dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript>
    <a href="https://disqus.com" class="dsq-brlink" rel="nofollow">Comments powered by <span class="logo-disqus">Disqus</span></a>


        </section><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" integrity="sha384-3lJUsx1TJHt7BA4udB5KPnDrlkO8T6J6v/op7ui0BbCjvZ9WqV4Xm6DTP6kQ/iBH" crossorigin="anonymous"></script><script type="text/x-mathjax-config">
        MathJax.Hub.Config({tex2jax: {inlineMath: [['$latex ','$'], ['\\(','\\)']]}});
        </script></article><script>var disqus_shortname="kyle-m-douglass";(function(){var a=document.createElement("script");a.async=true;a.src="https://"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script><!--End of body content--><footer id="footer">
            Contents © 2025         <a href="mailto:kyle.m.douglass@gmail.com">Kyle M. Douglass</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
<a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">
<img alt="Creative Commons License BY-NC-SA" style="border-width:0; margin-bottom:12px;" src="https://i.creativecommons.org/l/by-nc-sa/4.0/88x31.png"></a>
            
            
        </footer>
</div>
</div>


        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
